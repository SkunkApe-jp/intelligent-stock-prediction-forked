erDiagram
    USER {
        int id
        string email
        string username
        string password_hash
        string role
        decimal wallet_balance
        datetime created_at
        datetime last_login_at
        bool is_active
    }

    COMPANY {
        int id
        string symbol
        string name
        bool is_active
    }

    BROKER {
        int id
        string name
        decimal commission_rate
        bool is_active
    }

    PORTFOLIO_ITEM {
        int id
        int user_id
        int company_id
        int quantity
        decimal average_buy_price
    }

    TRANSACTION {
        int id
        int user_id
        int company_id
        int broker_id
        string txn_type
        int quantity
        decimal price
        decimal total_amount
        decimal commission_amount
        datetime created_at
        string description
    }

    DIVIDEND {
        int id
        int user_id
        int company_id
        decimal amount
        datetime created_at
    }

    USER ||--o{ PORTFOLIO_ITEM : "owns"
    COMPANY ||--o{ PORTFOLIO_ITEM : "is held in"

    USER ||--o{ TRANSACTION : "executes"
    COMPANY ||--o{ TRANSACTION : "is traded in"
    BROKER ||--o{ TRANSACTION : "charges commission on"

    USER ||--o{ DIVIDEND : "receives"
    COMPANY ||--o{ DIVIDEND : "issues"